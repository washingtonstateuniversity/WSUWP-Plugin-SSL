var wsuTLS=wsuTLS||{};!function(s,n,a,e,t){"use strict";t.appView=n.View.extend({el:".wsu-manage-tls",domain:"",row:"",events:{"click #submit-add-domain":"handle_submit_click","click .confirm_tls":"handle_confirm_click","click .check_tls":"handle_tls_check","click .view_csr":"view_csr","click .view-csr-close":"remove_csr_response","click .tls-status-close":"remove_tls_response"},handle_submit_click:function(){this.domain=a("#add-domain").val(),this.unconfirm_tls_domain(this.domain)},handle_confirm_click:function(n){this.domain=a(n.target).attr("data-domain"),this.row=a(n.target).parents("tr").attr("id"),!0===s.confirm("Removing "+this.domain+" from the TLS confirmation list.")&&this.confirm_tls_domain(this.domain)},handle_tls_check:function(n){this.domain=a(n.target).attr("data-domain");var e=a("#tls_ajax_nonce").val(),t={action:"check_tls",domain:this.domain,ajax_nonce:e};a.post(s.ajaxurl,t,this.check_tls_response)},check_tls_response:function(s){(s=a.parseJSON(s)).success&&(a(".tls-status-container-body").html(s.success),a(".tls-status-container-wrapper").show())},view_csr:function(n){this.domain=a(n.target).attr("data-domain");var e=a("#tls_ajax_nonce").val(),t={action:"view_csr",domain:this.domain,ajax_nonce:e};a.post(s.ajaxurl,t,this.view_csr_response)},view_csr_response:function(s){(s=a.parseJSON(s)).success&&(a(".view-csr-container-body").html("<textarea>"+s.success+"</textarea>"),a(".view-csr-container-wrapper").show())},remove_csr_response:function(){a(".view-csr-container-body").html(""),a(".view-csr-container-wrapper").hide()},remove_tls_response:function(){a(".tls-status-container-body").html(""),a(".tls-status-container-wrapper").hide()},unconfirm_tls_domain:function(n){var e={action:"unconfirm_tls",domain:n,ajax_nonce:a("#tls_ajax_nonce").val()};a.post(s.ajaxurl,e,this.handle_unconfirm_response)},handle_unconfirm_response:function(n){(n=a.parseJSON(n)).success?(a("#add-domain").val(""),s.location.reload()):n.error&&(a("#tls-error-message").html("<strong>Error:</strong> "+n.error),a("#tls-error-message").css("display","block"))},confirm_tls_domain:function(n){var e={action:"confirm_tls",domain:n,ajax_nonce:a("#tls_ajax_nonce").val()};a.post(s.ajaxurl,e,this.handle_confirm_response)},handle_confirm_response:function(s){(s=a.parseJSON(s)).success&&a("#"+t.app.row).remove()}}),t.app=new t.appView}(window,Backbone,jQuery,_,wsuTLS);